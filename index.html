<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tcaw Games</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
    body { background: #0a0a0a; min-height: 100vh; color: white; }

    /* Navbar fix */
    .navbar-logo { width: 50px; height: auto; border-radius: 50%; object-fit: contain; }

    /* other CSS unchanged ... */
    /* Keep all your previous CSS here, same as before */
  </style>
</head>
<body>

  <!-- Navbar will be loaded here -->
  <div id="navbarContainer"></div>

  <!-- Search + Categories -->
  <section class="search-section">
    <div class="categories">
      <div class="category-tab active" data-category="all"><i class="fas fa-star"></i> All</div>
      <div class="category-tab" data-category="sports"><i class="fas fa-football-ball"></i> Sports</div>
      <div class="category-tab" data-category="fighting"><i class="fas fa-fist-raised"></i> Fighting</div>
      <div class="category-tab" data-category="arcade"><i class="fas fa-gamepad"></i> Arcade</div>
      <div class="category-tab" data-category="racing"><i class="fas fa-car"></i> Racing</div>
      <div class="category-tab" data-category="idle"><i class="fas fa-leaf"></i> Idle</div>
      <div class="category-tab" data-category="casual"><i class="fas fa-smile"></i> Casual</div>
    </div>

    <div class="search-bar">
      <input type="text" id="searchInput" placeholder="Search games..." />
      <button id="searchBtn"><i class="fas fa-search"></i></button>
    </div>
  </section>

  <!-- Games Section -->
  <section class="content-section">
    <h2 class="section-title">Games Library</h2>

    <div class="loading" id="loadingState">
      <i class="fas fa-spinner fa-spin"></i> Loading games...
    </div>

    <div class="games-grid" id="gamesGrid" style="display: none;"></div>

    <div class="error" id="errorState" style="display: none;">
      <i class="fas fa-exclamation-triangle" style="font-size: 2rem;"></i>
      <p>Failed to load games. Try again later.</p>
    </div>
  </section>

  <footer class="footer">
    <p>&copy; 2025 Tcaw Games. All rights reserved.</p>
  </footer>

  <script>
    // Load navbar dynamically
    fetch('navbar.html')
      .then(res => res.text())
      .then(data => {
        document.getElementById('navbarContainer').innerHTML = data;
      })
      .catch(err => console.error('Failed to load navbar:', err));

    // Game loading script unchanged ...
    const loadingState = document.getElementById('loadingState');
    const gamesGrid = document.getElementById('gamesGrid');
    const errorState = document.getElementById('errorState');
    let allGames = [];

    async function loadGames() {
      try {
        const res = await fetch('games.json');
        if (!res.ok) throw new Error('Failed to load');
        const data = await res.json();
        allGames = data.games;
        displayGames(allGames);
      } catch (err) {
        console.error(err);
        showError();
      }
    }

    function displayGames(games) {
      loadingState.style.display = 'none';
      gamesGrid.innerHTML = '';
      games.forEach(g => {
        const card = document.createElement('div');
        card.className = 'game-card';
        card.innerHTML = `
          <img src="${g.icon}" class="game-icon" onerror="this.src='https://via.placeholder.com/80/1a1a1a/00ff9d?text=ðŸŽ®'">
          <h3 class="game-name">${g.displayName || g.name}</h3>
          <span class="game-category">${g.category}</span>
          <p class="game-description">${g.description}</p>
          <a href="https://tclaws.xyz/${g.url}" class="game-btn"><i class="fas fa-play"></i> Play</a>
        `;
        gamesGrid.appendChild(card);
      });
      gamesGrid.style.display = 'grid';
    }

    function showError() {
      loadingState.style.display = 'none';
      gamesGrid.style.display = 'none';
      errorState.style.display = 'block';
    }

    function searchGames(query) {
      const filtered = allGames.filter(g =>
        g.name.toLowerCase().includes(query.toLowerCase()) ||
        g.category.toLowerCase().includes(query.toLowerCase())
      );
      displayGames(filtered);
    }

    document.getElementById('searchBtn').addEventListener('click', () => {
      const query = document.getElementById('searchInput').value.trim();
      searchGames(query);
    });

    document.getElementById('searchInput').addEventListener('input', e => {
      searchGames(e.target.value);
    });

    document.addEventListener('click', e => {
      if (e.target.classList.contains('category-tab')) {
        document.querySelectorAll('.category-tab').forEach(t => t.classList.remove('active'));
        e.target.classList.add('active');
        const cat = e.target.dataset.category;
        if (cat === 'all') displayGames(allGames);
        else displayGames(allGames.filter(g => g.category.toLowerCase() === cat.toLowerCase()));
      }
    });

    document.addEventListener('DOMContentLoaded', loadGames);
  </script>
</body>
</html>
